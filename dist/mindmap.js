!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MindMap=e():t.MindMap=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>a});const s={node(t){const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild},flat(t,e=[],s=!1){return s&&e.push(t),t.children.forEach((t=>this.flat(t,e,!0))),e},offset(t,e){let s={width:e.size,height:e.size};return t.forEach((t=>{const{top:i,bottom:h,left:n,right:a}=t.getRect(),o=2*Math.max(Math.abs(n-e.x),Math.abs(a-e.x)),l=2*Math.max(Math.abs(i-e.y),Math.abs(h-e.y));o>s.width&&(s.width=o),l>s.height&&(s.height=l)})),s}},i={item({size:t}){const e=t+"px",i=t/-2+"px";return s.node(`<div class="mm-item" style="width: ${e}; height: ${e}; margin: ${i} 0 0 ${i}" />`)},line({radius:t,stroke:e}){const i=t+"px",h=e+"px",n=e/-2+"px",a=e/2+"px";return s.node(`<div class="mm-line" style="width: ${i}; height: ${h}; margin: ${n} 0 0 ${n}; transform-origin: ${a} ${a}" />`)},link:({link:t,classname:e,content:i})=>s.node(`<a ${t?`href="${t}"`:""} class="mm-link ${e}">${i}</a>`),loader:()=>s.node('\n            <svg class="mm-loader">\n                <circle r="50%" cx="50%" cy="50%"/>\n            </svg>\n        ')};class h{get defaults(){return{radius:0,angle:0,size:0,link:!1,classname:"",content:"",children:[]}}constructor(t,e,n){Object.assign(this,this.defaults,t),this.map=n,this.parent=e,this.level=this.parent.level+1,this.x=Math.cos(this.angle/180*Math.PI)*this.radius,this.y=Math.sin(this.angle/180*Math.PI)*this.radius,this.scale=this.parent.scale*this.size/this.parent.size,this.stroke=this.map.line*this.scale,this.$node=i.item(this),this.$line=i.line(this),this.$link=s.node(this.content),this.$link.classList.add("mm-link"),this.$link.addEventListener("click",(t=>this.map.click(this))),this.children=this.children.map((t=>new h(t,this,n))),this.offset=s.offset(this.children,this),this.$node.appendChild(this.$line),this.$node.appendChild(this.$link),this.validate(),this.hide(),e.$node.appendChild(this.$node)}show(){this.$node.style.transform=`translate(${this.x}px, ${this.y}px)`,this.$line.style.transform=`rotate(${180+this.angle}deg)`}hide(){this.$node.style.transform="translate(0, 0)",this.$line.style.transform=`rotate(${180+this.angle}deg) scaleX(0)`}validate(){this.children.length&&this.link&&alert('"link" not allowed here.')}getRect(){return{left:this.parent.x+this.x-this.size/2,right:this.parent.x+this.x+this.size/2,top:this.parent.y+this.y-this.size/2,bottom:this.parent.y+this.y+this.size/2}}hasChild(t){return t===this||this.children.find((e=>e.hasChild(t)))}}class n{get defaults(){return{size:0,scale:1,classname:"",content:"",children:[]}}constructor(t,e){Object.assign(this,this.defaults,t),this.map=e,this.level=-1,this.x=0,this.y=0,this.parent={},this.parent.x=0,this.parent.y=0,this.parent.offset={},this.parent.offset.width=this.size,this.parent.offset.height=this.size,this.$node=i.item(this),this.$loader=i.loader(),this.$link=s.node(this.content),this.$link.classList.add("mm-link"),this.$link.addEventListener("click",(t=>this.map.click(this))),this.children=this.children.map((t=>new h(t,this,e))),this.offset=s.offset(this.children,this),this.$node.appendChild(this.$link),this.$node.appendChild(this.$loader),this.map.$node.appendChild(this.$node),this.load()}load(){const t=this.$loader.querySelector("circle"),e=this.$node.getElementsByTagName("img"),s=t.getTotalLength();t.style.transition="none",t.style.strokeDasharray=s,t.style.strokeDashoffset=s;let i=0;const h=()=>{i++,t.style.transition="",t.style.strokeDashoffset=s-i/e.length*s,i===e.length&&(t.ontransitionend=()=>this.map.$node.classList.add("mm--loaded"))};for(let t=0;t<e.length;t++)e[t].onload=h,e[t].onerror=h}}class a{get defaults(){return{padding:0,line:10,minScale:.5}}constructor(t,e,i){Object.assign(this,this.defaults,e),this.$node=document.querySelector(t),this.$node.classList.add("mm"),this.scale=1,this.data=i,this.root=new n(i,this),this.items=s.flat(this.root),this.offset=s.offset(this.items,this.root),this.resize(),window.addEventListener("resize",(()=>this.resize()))}click(t){if(t.link)return window.open(t.link);this.items.forEach((e=>{e.level===t.level&&e!==t&&(e.active=!1),e.level>t.level&&(e.active=!1,e.hide())})),t.active?(t.active=!1,this.zoomTo(t.parent)):(t.active=!0,t.children.forEach((t=>t.show())),this.zoomTo(t))}getScale(t){const e=this.$node.offsetWidth/(t.width+2*this.padding),s=this.$node.offsetHeight/(t.height+2*this.padding);return Math.min(e,s)}resize(){this.scale=Math.max(this.getScale(this.offset),this.minScale),this.root.$node.style.transition="none",this.root.$node.style.transform=`scale(${this.scale})`}zoomTo(t){if(this.scale>this.minScale)return;const e=t.parent||{x:0,y:0},s=e.x+t.x,i=e.y+t.y,h=Math.min(this.getScale(t.offset),this.scale);this.root.$node.style.transition="",this.root.$node.style.transform=`scale(${h}) translate(${-s}px, ${-i}px)`}}return e.default})()}));