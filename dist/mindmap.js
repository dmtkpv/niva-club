!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MindMap=e():t.MindMap=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>n});const i={node(t){const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild},flat(t,e=[]){return e.push(t),t.children.forEach((t=>this.flat(t,e))),e},offset(t,e){let i={width:e.size,height:e.size};return t.forEach((t=>{const{top:s,bottom:h,left:n,right:a}=t.getRect(),l=2*Math.max(Math.abs(n-e.x),Math.abs(a-e.x)),o=2*Math.max(Math.abs(s-e.y),Math.abs(h-e.y));l>i.width&&(i.width=l),o>i.height&&(i.height=o)})),i}},s={item({size:t}){const e=t+"px",s=t/-2+"px";return i.node(`<div class="mm-item" style="width: ${e}; height: ${e}; margin: ${s} 0 0 ${s}" />`)},line({radius:t,stroke:e}){const s=t+"px",h=e+"px",n=e/-2+"px",a=e/2+"px";return i.node(`<div class="mm-line" style="width: ${s}; height: ${h}; margin: ${n} 0 0 ${n}; transform-origin: ${a} ${a}" />`)},link:({link:t,classname:e,content:s})=>i.node(`<a ${t?`href="${t}"`:""} class="mm-link ${e}">${s}</a>`)};class h{get defaults(){return{radius:0,angle:0,size:0,link:!1,classname:"",content:"",children:[]}}constructor(t,e,n){Object.assign(this,this.defaults,t),this.map=n,this.parent=e,this.level=this.parent.level+1,this.x=Math.cos(this.angle/180*Math.PI)*this.radius,this.y=Math.sin(this.angle/180*Math.PI)*this.radius,this.scale=this.parent.scale*this.size/this.parent.size,this.stroke=this.map.line*this.scale,this.$node=s.item(this),this.$line=s.line(this),this.$link=i.node(this.content),this.$link.classList.add("mm-link"),this.$link.addEventListener("click",(t=>this.map.click(this))),this.children=this.children.map((t=>new h(t,this,n))),this.offset=i.offset(this.children,this),this.$node.appendChild(this.$line),this.$node.appendChild(this.$link),this.validate(),this.hide(),e.$node.appendChild(this.$node)}show(){this.$node.style.transform=`translate(${this.x}px, ${this.y}px)`,this.$line.style.transform=`rotate(${180+this.angle}deg)`}hide(){this.$node.style.transform="translate(0, 0)",this.$line.style.transform=`rotate(${180+this.angle}deg) scaleX(0)`}validate(){this.children.length&&this.link&&alert('"link" not allowed here.')}getRect(){return{left:this.parent.x+this.x-this.size/2,right:this.parent.x+this.x+this.size/2,top:this.parent.y+this.y-this.size/2,bottom:this.parent.y+this.y+this.size/2}}hasChild(t){return t===this||this.children.find((e=>e.hasChild(t)))}}class n{get defaults(){return{padding:0,line:10,minScale:.5}}get origin(){const t=this.data.size;return{x:0,y:0,scale:1,level:-1,offset:{width:t,height:t},$node:this.$node,size:t}}constructor(t,e,s){Object.assign(this,this.defaults,e),this.$node=document.querySelector(t),this.$node.classList.add("mm"),this.scale=1,this.data=s,this.item=new h(s,this.origin,this),this.items=i.flat(this.item),this.offset=i.offset(this.items,this.origin),this.resize(),window.addEventListener("resize",(()=>this.resize()))}click(t){if(t.link)return window.open(t.link);this.items.forEach((e=>{e.level===t.level&&e!==t&&(e.active=!1),e.level>t.level&&(e.active=!1,e.hide())})),t.active?(t.active=!1,this.zoomTo(t.parent)):(t.active=!0,t.children.forEach((t=>t.show())),this.zoomTo(t))}getScale(t){const e=this.$node.offsetWidth/(t.width+2*this.padding),i=this.$node.offsetHeight/(t.height+2*this.padding);return Math.min(e,i)}resize(){this.scale=Math.max(this.getScale(this.offset),this.minScale),this.item.$node.style.transition="none",this.item.$node.style.transform=`scale(${this.scale})`}zoomTo(t){if(this.scale>this.minScale)return;const e=t.parent||{x:0,y:0},i=e.x+t.x,s=e.y+t.y,h=Math.min(this.getScale(t.offset),this.scale);this.item.$node.style.transition="",this.item.$node.style.transform=`scale(${h}) translate(${-i}px, ${-s}px)`}}return e.default})()}));